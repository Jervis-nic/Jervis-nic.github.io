<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="PhantomJS 可以看做是一个没有UI界面的webkit浏览器，这个东西用途很广泛，可以用来做网络监控，网页截屏，自动化测试等等，这里抛砖引玉，做个简单的介绍，就主要介绍下它截图的这功能。  1.安装到官网下载phantomjs.exe，然后复制文件所在路径D:\chrome download\phantomjs-2.1.1-windows\bin（这个是我的路径） ，在环境变量的系统变量中">
<meta property="og:type" content="article">
<meta property="og:title" content="使用PhantomJS对网页截屏">
<meta property="og:url" content="http://xiaojiecong.github.io/2017/08/27/使用PhantomJS对网页截屏/index.html">
<meta property="og:site_name" content="前端搜索者">
<meta property="og:description" content="PhantomJS 可以看做是一个没有UI界面的webkit浏览器，这个东西用途很广泛，可以用来做网络监控，网页截屏，自动化测试等等，这里抛砖引玉，做个简单的介绍，就主要介绍下它截图的这功能。  1.安装到官网下载phantomjs.exe，然后复制文件所在路径D:\chrome download\phantomjs-2.1.1-windows\bin（这个是我的路径） ，在环境变量的系统变量中">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://feg.netease.com/usr/uploads/2017/03/4252741625.png">
<meta property="og:image" content="http://feg.netease.com/usr/uploads/2017/03/1655246296.png">
<meta property="og:image" content="http://feg.netease.com/usr/uploads/2017/03/944031150.png">
<meta property="og:image" content="http://feg.netease.com/usr/uploads/2017/03/1833297422.png">
<meta property="og:image" content="http://feg.netease.com/usr/uploads/2017/03/2329043885.png">
<meta property="og:updated_time" content="2017-08-27T11:01:12.992Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用PhantomJS对网页截屏">
<meta name="twitter:description" content="PhantomJS 可以看做是一个没有UI界面的webkit浏览器，这个东西用途很广泛，可以用来做网络监控，网页截屏，自动化测试等等，这里抛砖引玉，做个简单的介绍，就主要介绍下它截图的这功能。  1.安装到官网下载phantomjs.exe，然后复制文件所在路径D:\chrome download\phantomjs-2.1.1-windows\bin（这个是我的路径） ，在环境变量的系统变量中">
<meta name="twitter:image" content="http://feg.netease.com/usr/uploads/2017/03/4252741625.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://xiaojiecong.github.io/2017/08/27/使用PhantomJS对网页截屏/"/>





  <title>使用PhantomJS对网页截屏 | 前端搜索者</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">前端搜索者</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://xiaojiecong.github.io/2017/08/27/使用PhantomJS对网页截屏/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jervis">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="前端搜索者">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">使用PhantomJS对网页截屏</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-27T18:58:23+08:00">
                2017-08-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>PhantomJS 可以看做是一个没有UI界面的webkit浏览器，这个东西用途很广泛，可以用来做网络监控，网页截屏，自动化测试等等，这里抛砖引玉，做个简单的介绍，就主要介绍下它截图的这功能。</p>
</blockquote>
<h3 id="1-安装"><a href="#1-安装" class="headerlink" title="1.安装"></a>1.安装</h3><p>到<a href="http://phantomjs.org/download.html" target="_balnk" style="color:#B94A48;">官网</a>下载<code>phantomjs.exe</code>，然后复制文件所在路径<code>D:\chrome download\phantomjs-2.1.1-windows\bin</code>（这个是我的路径） ，在环境变量的系统变量中找到path，添加即可，这样就可以在任意地方执行CMD命令操作PhantomJS了。</p>
<h3 id="2-使用"><a href="#2-使用" class="headerlink" title="2.使用"></a>2.使用</h3><p>demo.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> page = <span class="built_in">require</span>(<span class="string">'webpage'</span>).create();<span class="comment">//创建网页对象</span></div><div class="line"></div><div class="line">page.open(<span class="string">'http://game.163.com'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">status</span>) </span>&#123;</div><div class="line">	<span class="keyword">if</span> (status !== <span class="string">'success'</span>) &#123;</div><div class="line">		<span class="built_in">console</span>.log(<span class="string">'Unable to load the address!'</span>)</div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">		page.render(<span class="string">'a.jpg'</span>);<span class="comment">//导出a.jpg</span></div><div class="line">		phantom.exit();<span class="comment">//退出程序</span></div><div class="line">	&#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>在CMD命令行窗口输入 <code>phantomjs demo.js</code>，就可以导出game.163.com的截图了。这样我们在没有打开浏览器的情况就知道它页面长什么样了~</p>
<p><img src="http://feg.netease.com/usr/uploads/2017/03/4252741625.png" alt="1.png"></p>
<p>看截下来的图，会发现一些问题，截图宽度是1260，显示不全，最明显的是中间一块有留白。留白原因是有些页面可能是做了lazyload，需要滚动到相应的位置才会触发。下面进一步调整解决这个问题，这样就能看到完整的截图了，这里就不贴图了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> page = <span class="built_in">require</span>(<span class="string">'webpage'</span>).create();<span class="comment">//创建网页对象</span></div><div class="line"></div><div class="line">page.viewportSize = &#123; <span class="attr">width</span>: <span class="number">1920</span>, <span class="attr">height</span>: <span class="number">100</span> &#125;;<span class="comment">//高度可以随意给个值</span></div><div class="line">page.open(<span class="string">'http://game.163.com'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">status</span>) </span>&#123;</div><div class="line">	<span class="keyword">if</span> (status !== <span class="string">'success'</span>) &#123;</div><div class="line">		<span class="built_in">console</span>.log(<span class="string">'Unable to load the address!'</span>)</div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">		page.evaluate(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			scrollTo(<span class="number">0</span>, <span class="number">10000</span>); <span class="comment">//给个足够大的值滚动到底部</span></div><div class="line">		&#125;)</div><div class="line">		<span class="comment">//也可以截取某个区域</span></div><div class="line">		<span class="comment">// page.clipRect = &#123; </span></div><div class="line">		<span class="comment">// 	top: 0,</span></div><div class="line">		<span class="comment">// 	left: 0,</span></div><div class="line">		<span class="comment">// 	width: 1920,// 宽度</span></div><div class="line">		<span class="comment">// 	height: 400 //高度</span></div><div class="line">		<span class="comment">// &#125;</span></div><div class="line">		setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">			page.render(<span class="string">'a.jpg'</span>, &#123; <span class="comment">//导出a.jpg</span></div><div class="line">				format: <span class="string">'jpg'</span>,</div><div class="line">				quality: <span class="string">'100'</span> <span class="comment">//对比发现默认好像不是100，设置为100截图更清晰</span></div><div class="line">			&#125;);</div><div class="line">			phantom.exit(); <span class="comment">//退出程序</span></div><div class="line">		&#125;, <span class="number">1000</span>);</div><div class="line">	&#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>我们还可以在<code>page.evaluate</code>中的函数里对页面做一些操作，比如Dom操作…这里遍历了页面上所有的a元素，然后加个border，最后我们可以把这个效果截图导出来~<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">page.evaluate(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    scrollTo(<span class="number">0</span>, <span class="number">10000</span>); <span class="comment">//给个足够大的值滚动到底部</span></div><div class="line">	<span class="keyword">var</span> aList = <span class="built_in">document</span>.querySelectorAll(<span class="string">"a"</span>);</div><div class="line">	[].forEach.call(aList,<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;</div><div class="line">	  a.style.border=<span class="string">"1px solid red"</span>;</div><div class="line">	&#125;)</div><div class="line">&#125;);</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p><img src="http://feg.netease.com/usr/uploads/2017/03/1655246296.png" alt="2.png"></p>
<h4 id="System-Module"><a href="#System-Module" class="headerlink" title="System Module"></a>System Module</h4><p>System模块是PhantomJS的一个API，下面将使用system模块提供的args。</p>
<ul>
<li>system.args {String[]}  获取运行phantomjs时传入的所有参数</li>
</ul>
<p>从上面的介绍看，很多东西都是写死的，比如图片大小的设置，url，图片名称等等。我们可以使用system.args来代替这些。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> page = <span class="built_in">require</span>(<span class="string">'webpage'</span>).create(),</div><div class="line">	address, output, sizeX , sizeY;</div><div class="line"><span class="keyword">var</span> system = <span class="built_in">require</span>(<span class="string">'system'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> arg_count = system.args.length;</div><div class="line"><span class="keyword">if</span> (arg_count !=  <span class="number">5</span>) &#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'Usage: **.js URL filename sizeX sizeY'</span>);</div><div class="line">	phantom.exit();</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line"></div><div class="line">	address = system.args[<span class="number">1</span>];</div><div class="line">	output = system.args[<span class="number">2</span>];</div><div class="line">	sizeX = system.args[<span class="number">3</span>];</div><div class="line">	sizeY = system.args[<span class="number">4</span>];</div><div class="line">	page.viewportSize = &#123;</div><div class="line">		width: sizeX,</div><div class="line">		height: sizeY</div><div class="line">	&#125;;</div><div class="line">	page.open(address, <span class="function"><span class="keyword">function</span>(<span class="params">status</span>) </span>&#123;</div><div class="line">		<span class="keyword">if</span> (status !== <span class="string">'success'</span>) &#123;</div><div class="line">			<span class="built_in">console</span>.log(<span class="string">'Unable to load the address!'</span>);</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line">			page.evaluate(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">			      scrollTo(<span class="number">0</span>, <span class="number">10000</span>); <span class="comment">//给个足够大的值滚动到底部</span></div><div class="line">			&#125;);</div><div class="line">			setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">				page.render(output, &#123;</div><div class="line">					format: <span class="string">'jpg'</span>,</div><div class="line">					quality: <span class="string">'100'</span> <span class="comment">//对比发现默认好像不是100，设置为100截图更清晰</span></div><div class="line">				&#125;);</div><div class="line">				phantom.exit();</div><div class="line">			&#125;, <span class="number">1000</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>我们试下对<a href="http://my.163.com" target="_blank">梦幻官网</a>截屏，输入CMD命令，其中demo.js就是第一个参数，以此类推…<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">phantomjs demo.js http://my.163.com bg.jpg 1920 1000</div></pre></td></tr></table></figure></p>
<p>观察导出的效果图，又发现问题了，第一，有个黑色透明弹层(不支持flash，视频没显示出来，这问题忽略)。第二，可以看到中间一块是黑色的。我想拿到一开始没有视频弹窗，而且中间的一块不会出现黑色的截图，怎么办？（温馨提示：如果你看到页面不是这样，梦幻官网有可能改版了~）<br><img src="http://feg.netease.com/usr/uploads/2017/03/944031150.png" alt="3.png"></p>
<h3 id="addCookie"><a href="#addCookie" class="headerlink" title="addCookie"></a>addCookie</h3><p>Phantomjs有操作Cookie的一些API。</p>
<ul>
<li>addCookie(Object) {Boolean}</li>
</ul>
<p>这个是官网的一个例子<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">phantom.addCookie(&#123;</div><div class="line">  &apos;name&apos;: &apos;Added-Cookie-Name&apos;,</div><div class="line">  &apos;value&apos;: &apos;Added-Cookie-Value&apos;,</div><div class="line">  &apos;domain&apos;: &apos;.google.com&apos;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p><a href="http://my.163.com" target="_blank" style="color:#B94A48;">梦幻官网</a>现在有这样的一个逻辑，当你第一次访问的时候，会有个判断，如果没有相关的Cookie，就会出现视频弹窗，然后下次访问就没有了。一开始，我们可以手动种一下Cookie，去掉这个视频弹窗，然后最后截取到没有透明黑色弹层的页面。</p>
<p>到<a href="http://my.163.com" target="_blank" style="color:#B94A48;">梦幻官网</a>，打开开发者工具，找到这个cookie</p>
<p><img src="http://feg.netease.com/usr/uploads/2017/03/1833297422.png" alt="12.png"></p>
<p>具体代码如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> page = <span class="built_in">require</span>(<span class="string">'webpage'</span>).create(),</div><div class="line">	address, output, sizeX , sizeY;</div><div class="line"><span class="keyword">var</span> system = <span class="built_in">require</span>(<span class="string">'system'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> arg_count = system.args.length;</div><div class="line"><span class="keyword">if</span> (arg_count != <span class="number">5</span>) &#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'Usage: **.js URL filename sizeX sizeY'</span>);</div><div class="line">	phantom.exit();</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line"></div><div class="line">	address = system.args[<span class="number">1</span>];</div><div class="line">	output = system.args[<span class="number">2</span>];</div><div class="line">	sizeX = system.args[<span class="number">3</span>];</div><div class="line">	sizeY = system.args[<span class="number">4</span>];</div><div class="line"></div><div class="line">	page.viewportSize = &#123;</div><div class="line">		width: sizeX,</div><div class="line">		height: sizeY</div><div class="line">	&#125;;</div><div class="line">	phantom.addCookie(&#123;</div><div class="line">		<span class="string">'name'</span>: <span class="string">'myVideoPop'</span>,</div><div class="line">		<span class="string">'value'</span>: <span class="string">'1'</span>,</div><div class="line">		<span class="string">'domain'</span>: <span class="string">'my.163.com'</span></div><div class="line">	&#125;);</div><div class="line">	page.open(address, <span class="function"><span class="keyword">function</span>(<span class="params">status</span>) </span>&#123;</div><div class="line">		<span class="keyword">if</span> (status !== <span class="string">'success'</span>) &#123;</div><div class="line">			<span class="built_in">console</span>.log(<span class="string">'Unable to load the address!'</span>);</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line"></div><div class="line">			page.evaluate(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">				scrollTo(<span class="number">0</span>, <span class="number">10000</span>); </div><div class="line">			&#125;);</div><div class="line">			setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">				page.render(output, &#123;</div><div class="line">					format: <span class="string">'jpg'</span>,</div><div class="line">					quality: <span class="string">'100'</span></div><div class="line">				&#125;);</div><div class="line">				phantom.exit();</div><div class="line">			&#125;, <span class="number">1000</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这次导出的效果图：</p>
<p><img src="http://feg.netease.com/usr/uploads/2017/03/2329043885.png" alt="11.png"></p>
<p>可以看到黑色透明弹层终于没了，还剩最后一个问题，为啥那块是黑色的呢，原因也简单，因为没有背景色，需要我们加个背景色，然后就可以去掉黑块了。这问题官网给了答案。</p>
<blockquote>
<p>Q: When using render(), why is the background transparent?</p>
<p>A: PhantomJS does not set the background color of the web page at all, it is left to the page to decide its background color. If the page does not set anything, then it remains transparent.</p>
<p>To set an initial background color for a web page, use the following trick:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">page.evaluate(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">document</span>.body.bgColor = <span class="string">'white'</span>;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
</blockquote>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/08/27/基于NodeJs的自定义命令行图片压缩工具制作/" rel="prev" title="基于NodeJs的自定义命令行图片压缩工具制作">
                基于NodeJs的自定义命令行图片压缩工具制作 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.jpg"
               alt="Jervis" />
          <p class="site-author-name" itemprop="name">Jervis</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives/">
            
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-安装"><span class="nav-number">1.</span> <span class="nav-text">1.安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-使用"><span class="nav-number">2.</span> <span class="nav-text">2.使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#System-Module"><span class="nav-number">2.1.</span> <span class="nav-text">System Module</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#addCookie"><span class="nav-number">3.</span> <span class="nav-text">addCookie</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jervis</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div>

  <span class="post-meta-divider">|</span>

  <div class="theme-info">主题 &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.2</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
